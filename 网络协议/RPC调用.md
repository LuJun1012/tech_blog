# RPC调用
#### 解决的问题
* 问题一：如何规定远程调用的语法？
* 问题二：如果传递参数？
* 问题三：如何表示数据？
* 问题四：如何知道一个服务端都实现了哪些远程调用？从哪个端口可以访问这个远程调用？
* 问题五：发生了错误、重传、丢包、性能等问题怎么办？

#### 协议约定问题
* ![8534c52daf3682cd1cfe5a3375e](media/15489915615746/8534c52daf3682cd1cfe5a3375ec9525.jpg)
* 用户层 专注业务逻辑处理
* Stub 处理双方约定好的语法语义
* RPCRuntime 处理高性能的传输，以及网络的错误和异常

#### RPC
* 处理的数据类型
* Boolean
* 变长类型数据
* 变长数组
* 链表

#### 协议约定
* TLV Tag,Length,Value

#### 网络传输
* 单向RPC
* 服务流式RPC
* 客户流式RPC
* 双向流式RPC

#### 服务发现和服务治理
* Envoy负载均衡器
* 配置路由策略
* 负载均衡策略
* Serivce Mesh，也即应用之间的相互调用全部由 Envoy 进行代理，服务之间的治理也被 Envoy 进行代理，完全将服务治理抽象出来，到平台层解决

#### Service Mesh 的时候，我们说了，希望 Envoy 能够在服务不感知的情况下，将服务之间的调用全部代理了的内部原理
* 容器系统中，是通过 sidecar 模式来解决的，服务容器都是直接和 envoy sidecar 互通，envoy 的配置变化，网络拓扑的改变对服务容器都是不可感知的。service mesh 还更进一步的发展，istio 和 conduit，他们都是在 sidecar 基础上，又加了一个总的数据控制平面，来加强 service mesh 的掌控能力。
* 