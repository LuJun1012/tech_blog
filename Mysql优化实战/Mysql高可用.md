# Mysql高可用
#### seconds_behind_master
* 每个事务的 binlog 里面都有一个时间字段，用于记录主库上写入的时间；
* 备库取出当前正在执行的事务的时间字段的值，计算它与当前系统时间的差值，得到 seconds_behind_master。

#### 主备延迟
* 备库机器性能比较差
* 备库压力大
 * 一主多从
 * 通过binlog输出到外部系统如hadoop 
* 大事务 一次性删除太多历史数据 大表DDL
* 备库的并行复制能力

#### 可靠性优先策略
* 双M结构下主从切换，然后等切换成主库的备库的seconds_behind_master=0,把备库改成可读写状态
* ![54f4c7c31e6f0f807c2ab77f78c8844a](media/15477155524350/54f4c7c31e6f0f807c2ab77f78c8844a.png)

#### 可用性优先策略
* 双M主备的切换过程中，不等主备同步，直接把连接切到备库
* 如果binglog是statement会导致主备不一致，如果是row则会抛出异常不会执行
* 