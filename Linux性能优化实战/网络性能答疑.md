# 网络性能答疑
#### 网络收发缓冲区
* 网卡收发网络包时，通过 DMA 方式交互的环形缓冲区
* 网卡中断处理程序为网络帧分配的，内核数据结构 sk_buff 缓冲区,链表中的每一个元素都是一个网络帧（Packet）
* 应用程序通过套接字接口，与网络协议栈交互时的套接字缓冲区。
* sk_buff、套接字缓冲、连接跟踪通过slab分配器来管理, /proc/slabinfo查看

#### 内核协议栈处理线程
* 软中断处理，就有专门的内核线程 ksoftirqd。每个 CPU 都会绑定一个 ksoftirqd 内核线程

#### 最大连接数的限制
* Linux 协议栈，通过五元组来标志一个连接（即协议，源 IP、源端口、目的 IP、目的端口)
* 客户端最大支持65535, 服务端是海量的

#### MASQUERADE性能问题
* 当多个内网 IP 地址的端口号相同时，MASQUERADE 当然仍可以正常工作
* 连接跟踪
* MASQUERADE 机器的网络带宽